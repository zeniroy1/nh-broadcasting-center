# 📋 근태 자동화 시스템 가이드

## 📁 파일 구성

| 파일명 | 용도 |
|--------|------|
| `기본양식-메크로.xlsm` | 빈 근태기록표 양식 (매크로 포함) |
| `기본양식-메크로.csv` | 양식 CSV 버전 |
| `001_2025_10_MON.csv` / `_UTF8.csv` | 실제 근태 데이터 예시 |
| `자동화 테이블.xlsm` / `.csv` | 월별 날짜 테이블 템플릿 |
| `근태자동메크로코드0108.txt` | VBA 매크로 소스 코드 |

---

## 📝 기본양식 구조 (기본양식-메크로)

```
행 1: (0월) 출 근 일 자 기 록 표
행 3: 날짜 범위 (2026.00.00 ~ 2026.00.00)    작성자
행 5: 날짜 헤더 (1~31일)

행 6-7:   직원1 - 박세영
행 8-9:   직원2 - 김동석
행 10-11: 직원3 - 김준호
행 12-13: 직원4 - 함현식
행 14-15: 직원5 - 김성주
행 16-17: 직원6 - 주경훈
행 18-19: 직원7 - 이동근
행 20-21: 직원8 - 윤태우
행 22-23: 직원9 - 박성준
행 24-25: 직원10 - 주희준

행 26: 총 계급, 직급, 합계
행 27: 총 근무일수
```

---

## 👥 직원 목록 (10명)

| 사원번호 | 성명 | 부서 |
|----------|------|------|
| 1 | 박세영 | 방송 |
| 2 | 김동석 | 방송 |
| 3 | 김준호 | 방송 |
| 4 | 김성주 | 방송 |
| 5 | 주경훈 | 방송 |
| 6 | 이동근 | 방송 |
| 8 | 윤태우 | 방송 |
| 10 | 함현식 | 방송 |
| 11 | 주희준 | 방송 |
| 12 | 박성준 | 방송 |

---

## ⚙️ 매크로 로직 (`근태자동정리`)

### 처리 대상 행
날짜 헤더 행: `4, 7, 10, 13, 16, 19, 22, 25, 28, 31`

### 출퇴근 시간 설정

| 구간 | 출근 | 퇴근 |
|------|------|------|
| **일반** | 08:40 ~ 08:50 | 18:00 ~ 18:10 |
| **Z6:AE6 (박세영)** | 08:00 ~ 08:30 | 17:30 ~ 17:35 |

### 처리 규칙

#### 1~25일 (기존 데이터 정리)
| 상황 | 처리 |
|------|------|
| 시간 3개 이상 | 첫 번째 → 출근, 마지막 → 퇴근 |
| 시간 2개 (둘 다 오전) | 첫 번째 유지, 퇴근 랜덤 생성 |
| 시간 1개 (오전) | 그대로, 퇴근 랜덤 생성 |
| 시간 1개 (오후) | 출근 랜덤 생성, 그대로 |

#### 26~31일 (미래 데이터 생성)
| 요일 | 처리 |
|------|------|
| **평일** | 출퇴근 시간 랜덤 생성 |
| **주말** | 공란 유지 |

### 스킵 조건
- 병합된 셀
- 하늘색 배경 셀 `RGB(0, 176, 240)` - 휴가/특이사항

### 숨김 영역 (값 삭제)
```
Z5:AE5, Z8:AE8, Z11:AE11, Z14:AE14,
Z17:AE17, Z20:AE20, Z23:AE23, Z26:AE26,
Z29:AE29, Z32:AE32
```

---

## 📊 실제 데이터 예시 (2026년 1월)

### 김동석 (사원번호 2)
| 1일 | 2일 | 10일 | 13일 | 14일 | 15일 |
|-----|-----|------|------|------|------|
| 08:39<br>18:12 | 07:03<br>17:38 | 06:53<br>13:45 | 06:44<br>17:34 | 07:03<br>17:29 | 06:53<br>17:32 |

### 박세영 (사원번호 1) - 특별 시간대
| 1일 | 13일 | 14일 | 16일 | 19일 |
|-----|------|------|------|------|
| 07:05<br>18:12 | 08:23<br>18:20 | 08:30<br>17:30 | 08:40<br>17:35 | 09:41<br>20:12 |

---

## 🔧 사용 방법

1. `기본양식-메크로.xlsm` 열기
2. 원시 출퇴근 데이터 붙여넣기
3. **Alt + F8** → `근태자동정리` 실행
4. 자동 정리 완료 알림 확인

---

## 📌 주의사항

- 휴가/특이사항은 하늘색 배경으로 표시 (매크로 스킵)
- 26일 이후는 현재 날짜 기준 주말 자동 판별
- 원본 셀 서식(번호 포맷, 들여쓰기 등) 유지됨
